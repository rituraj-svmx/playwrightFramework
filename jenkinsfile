pipeline {
  agent { label 'windows' }
  parameters {
    choice(name: 'TestCasesGroup', choices: ['Regression','web'], description: 'npm script to run')
  }
  stages {
    stage('Install'){ steps { bat 'npm ci' ; bat 'npx playwright install' } }
    stage('Test'){ steps { bat "npm run %TestCasesGroup%" } }
  }
 post {
  always {
    bat 'npm run allure:report || exit /b 0'
    archiveArtifacts artifacts: 'allure-report/**, allure-results/**, playwright-report/**', fingerprint: true, onlyIfSuccessful: false
  }
}
}